#:kivy 1.9.2
#:import images_path kivymd.images_path
#:import FadeTransition kivy.uix.screenmanager.FadeTransition

<ScreenManagement>:
    transition: FadeTransition()
    create_screen: create_screen
    MainScreen:
        id: main_screen
    OptionsScreen:
    CreateLobbyScreen:
        id: create_screen
    ConnectScreen:
    PlaygroundScreen:


<MainScreen>:
    name: 'main'
    AnchorLayout:
        anchor_x: "center"
        anchor_y: "center"

        AnchorLayout:
            anchor_x: "center"
            anchor_y: "center"

            GridLayout:
                orientation: "vertical"
                size_hint: (0.3, 0.5)
                spacing: 50
                cols: 1

                Image:
                    source: 'silver.jpg'
                    size_hint_x: 1
                    size_hint_y: 0.3
                    allow_stretch: True

                BoxLayout:
                    orientation: "vertical"
                    size_hint: (1, 0.2)
                    spacing: 20

                    Button:
                        text: "Create Lobby"
                        on_press: root.manager.current = "createlobby"
                        on_press: root.isAdmin_change(True)
                        on_press: root.push_button_sound()
                    Button:
                        text: "Connect"
                        on_press: root.manager.current = "connect"
                        on_press: root.isAdmin_change(False)
                        on_press: root.push_button_sound()

    AnchorLayout:
        anchor_x: "right"
        anchor_y: "bottom"
            
        BoxLayout:
            orientation: "vertical"
            size_hint: (0.2, 0.1)
            spacing: 10

            Button:
                halign: "center"
                valign: "middle"
                text: "Settings"
                on_press: root.manager.current = "options"
                on_press: root.push_button_sound()

            Button:
                halign: "center"
                valign: "middle"
                text: "X"            
    


<OptionsScreen>:
    name: 'options'

    AnchorLayout:
        anchor_x: "left"
        anchor_y: "top"

        BoxLayout:
            orientation: "vertical"
            size_hint: (0.1, 0.1)
            spacing: 10

            Button:
                halign: "center"
                valign: "middle"
                text: "Back"
                on_press: root.manager.current = "main"
                on_press: root.push_button_sound()


    AnchorLayout:
        anchor_x: "center"
        anchor_y: "center"

        GridLayout:
            orientation: "vertical"
            size_hint: (0.8, 0.3)
            spacing: 0
            padding: 0
            cols: 3

            Label:
                text: "Music Volume"

            Slider:
                id: music_volume
                value: 10
                max: 10
                min: 0
                step: 1
                on_value: root.change_music_volume(music_volume.value)
                
            Label:
                size_hint: (0.1, 0.1)
                text: str(music_volume.value)

            Label:
                size_hint: (0.1, 0.1)
                text: "Effects Volume"

            Slider:
                id: effects_volume
                value: 10
                max: 10
                min: 0
                step: 1
                on_value: root.change_sound_of_push_volume(effects_volume.value)
                
            Label:
                text: str(effects_volume.value)

<CreateLobbyScreen>:
    name: 'createlobby'
    label_spyamount : lbl_spy
    token_layout : token_layout

    BoxLayout:
        orientation: "vertical"

        AnchorLayout:
            anchor_x: "left"
            anchor_y: "center"
            size_hint: (1, .1)

            Button:
                halign: "center"
                valign: "middle"
                text: "Back"
                size_hint: (.2, .5)
                on_press: root.manager.current = "main"
                on_press: root.push_button_sound()

        AnchorLayout:
            anchor_x: "center"
            anchor_y: "center"
            size_hint: (1, .2)
            
            GridLayout:
                orientation: "vertical"
                size_hint: (.6, .7)
                spacing: 30
                padding: 0
                cols: 2
                id: token_layout
                token_button : token_button

                Label:
                    id: token
                    text: "Token" 

                Button:                
                    id: token_button
                    halign: "center"
                    valign: "top"
                    text: ""
                    on_press: root.push_button_sound()


        AnchorLayout:
            anchor_x: "center"
            anchor_y: "center"
            size_hint: (1, .4)
            

            GridLayout:
                orientation: "vertical"
                size_hint: (1, 1)
                spacing: 0
                padding: 0
                cols: 3

                Label:
                    text: "Amount of players"

                Slider:
                    id: players_amount
                    max: 10
                    min: 5
                    step: 1
                    on_value: root.my_value(players_amount.value)
                        
                Label:
                    size_hint: (.2, .2)
                    text: str(players_amount.value)

                Label:
                    size_hint: (.2, .2)
                    text: "Amount of Spy"

                
                BoxLayout:
                    orientation: "horizontal"
                    size_hint: (.8, .4)
                        
                    Button:
                        halign: "center"
                        valign: "middle"
                        text: "-1"
                        on_press: root.delete_spy()
                        on_press: root.push_button_sound()

                    Label:
                        id: lbl_spy
                        text: '1'

                    Button:
                        halign: "center"
                        valign: "middle"
                        text: "+1"
                        on_press: root.add_spy()
                        on_press: root.push_button_sound()
        AnchorLayout:
            anchor_x: "center"
            anchor_y: "center"
            size_hint:(1, .3)
            
            GridLayout:
                size_hint:(.5, .5)
                cols: 2
                spacing : 20
                Button:
                    size_hint:(.3,.2)
                    text:"Play"
                    on_press: root.manager.current = "playground"
                    on_press: root.push_button_sound()

                Button:
                    size_hint:(.1,.2)
                    text:"Apply"
                    on_press: root.appear_token()
                    on_press: root.push_button_sound()



<ConnectScreen>:
    name: 'connect'
    token: token_id
    AnchorLayout:
        anchor_x: "left"
        anchor_y: "top"

        Button:
            halign: "center"
            valign: "middle"
            text: "Back"
            size_hint: (.1, .1)
            on_press: root.manager.current = "main"
            on_press: root.push_button_sound()

    AnchorLayout:
        anchor_x: "center"
        anchor_y: "center"
        size_hint: (1, .8)
        
        GridLayout:
            orientation: "vertical"
            size_hint: (.6, .7)
            spacing: 30
            padding: 0
            rows: 3

            Label:
                id: token
                text: "Token" 

            TextInput:
                id: token_id
                hint_text: "Enter Token"   
                multiline: "false"
                font_size: 30

            Button:                
                halign: "center"
                valign: "top"
                text: "Enter Game"
                on_press: root.enter_game(root.token.text)
                on_press: root.manager.current = "playground"
                on_press: root.push_button_sound()

<PlaygroundScreen>:
    name: 'playground'
    on_enter : root.enter_screen()
    lcl : root.locations
    grid : grid
    role_layout : role_layout
    

    BoxLayout:
        orientation: "vertical"
        
        AnchorLayout:
            anchor_x: "center"
            anchor_y: "bottom"
            size_hint: (1, .2)
            id: role_layout
            role_popup : role_popup

            MDFillRoundFlatButton:
                id: role_popup     
                size_hint: (0.2, 0.5)           
                halign: "center"
                valign: "top"
                text: "Role"
                icon: "language-python"
                on_press: root.rolePopup()
                on_press: root.push_button_sound()


        AnchorLayout:
            anchor_x: "center"
            anchor_y: "center"

            GridLayout:
                id: grid
                cols: 2
                size_hint: (.7, .6)
                spacing: 10
